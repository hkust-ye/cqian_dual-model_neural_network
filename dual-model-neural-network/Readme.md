Code for the dual-model neural network
